import{_ as N,Z as A,$ as B,a6 as I,aa as J,a8 as j,a0 as P,a1 as c,a2 as _,ad as e,d,a3 as T,ai as n,aM as p,a5 as U,J as O,af as Y,b6 as R,ah as $,ae as Q,ak as H}from"./index.bacfec48.js";import{Q as L}from"./QExpansionItem.c1b49321.js";import{Q as Z}from"./QSelect.0b2e4f76.js";import{u as G}from"./index.91f2720f.js";import{c as m}from"./index.e03e1fb1.js";import{g as z,p as K,r as F}from"./generateHeaders.c61a8e24.js";import{u as W}from"./auth_user_store.fb6dbab9.js";import{f as X}from"./index.e3cc403f.js";import"./QItemLabel.74f9032e.js";import"./QMenu.7f6159df.js";import"./position-engine.bab6871e.js";import"./selection.0f6ce218.js";import"./format.a33550d6.js";import"./axios.a3b240ae.js";const{getMe:ee}=A(W()),te={props:{resume:[Object]},setup(){return{v$:G()}},data(){return{form:{opportunity_type:null,about_the_applicant:null,internship_start_date:null},resume_upload:null}},validations(){return{form:{opportunity_type:{required:m.withMessage("Opportunity type is required",t=>!!t)},about_the_applicant:{required:m.withMessage("Your description is required",t=>!!t),min_length:m.withMessage("Your description must be atleast 50 words",t=>!((t==null?void 0:t.length)<=100))}}}},computed:{minDate(){const t=new Date;return X(t,"yyy-MM-dd")},getMe(){return ee.value}},components:{Uploader:B(()=>I(()=>import("./Uploader.4dedb271.js"),["assets/Uploader.4dedb271.js","assets/index.bacfec48.js","assets/index.dc4e4c7b.css"]))},mounted(){const t=this.resume;for(let[s,l]of Object.entries(this.form))this.form[s]=t[s]||l},methods:{handleCVFile(t){this.resume_upload=t},async submit(){try{if(this.v$.$touch(),this.v$.$error)return;let t={...this.form,id:this.resume.id};this.encryptionEnabled&&(t=J(JSON.stringify(t)));let l=(await this.$api.patch("/api/v1/resumes/update/",t,{headers:{...z()}})).data;this.encryptionEnabled&&(l=JSON.parse(j(l)));const{message:a,success:r,results:o}=l;this.resume_upload&&await this.uploadDocument({resume_id:this.resume.id}),K({message:a}),this.$emit("update_data_from_backend",!0),this.$router.go(-1)}catch(t){F({caller:"Application",error:t,api_encryption_enabled:this.api_encryption_enabled})}},async uploadDocument({resume_id:t}){try{const s=new FormData;s.append("resume_id",t),s.append("applicant_cv",this.resume_upload.file);let a=(await this.$api.post("/api/v1/resumes/upload/",s,{headers:{...z(),"Content-Type":"multipart/form-data"}})).data;this.encryptionEnabled&&(a=JSON.parse(j(a)));const{message:r,success:o,results:u}=a;return!0}catch(s){return F({caller:"document upload",error:s,api_encryption_enabled:this.api_encryption_enabled}),!1}}}},se={class:"form-container"},oe=e("div",{class:"text-center text-h6 q-mb-md"},"Application",-1),ie={class:"flex justify-between"},ae={class:"q-pa-none"},ne=e("div",{class:"text-weight-bold"},"First name",-1),re={class:"text-capitalize"},de={class:"q-pa-none",style:{"min-width":"150px"}},le=e("div",{class:"text-weight-bold"},"First name",-1),ce={class:"text-capitalize"},_e={class:"flex justify-between"},pe={class:"q-pa-none"},me=e("div",{class:"text-weight-bold"},"Phone number",-1),ue={class:""},he={class:"q-pa-none",style:{"min-width":"150px"}},fe=e("div",{class:"text-weight-bold"},"Email",-1),ye={class:""},ve={class:"flex justify-between"},be={class:"q-pa-none"},xe=e("div",{class:"text-weight-bold"},"Institution ",-1),ge={class:"text-capitalize"},we={class:"q-pa-none",style:{"min-width":"150px"}},qe=e("div",{class:"text-weight-bold"},"Year of admission",-1),Me={class:"text-capitalize"},Ve={class:"flex justify-between"},Se={class:"q-pa-none"},De=e("div",{class:"text-weight-bold"},"Course ",-1),Ce={class:"text-capitalize"},Ee={class:"q-pa-none",style:{"min-width":"150px"}},ke=e("div",{class:"text-weight-bold"},"Year of admission",-1),je={class:"text-capitalize"},Ue={class:"form-fields q-mt-md"},Oe=e("div",{class:"text-center text-h6"},"Fill the form below",-1),Qe={class:"row",style:{gap:"10px"}},ze={class:"col-sm-grow col-xs-12"},Fe=e("div",{class:"q-my-xs"},"Select type of opportunity*",-1),Ne={key:0,class:"text-red"},Ae={class:"col-sm-grow col-xs-12"},Be=e("div",{class:"q-my-xs"},"Starting date",-1),Ie=["min"],Je={class:"q-my-sm"},Pe=e("div",{class:"q-my-xs"},"Describe yourself*",-1),Te={key:0,class:"text-red"},Ye={class:"q-my-sm"},Re=e("div",{class:""},"Upload CV*",-1),$e={class:"flex justify-between q-mt-md"};function He(t,s,l,a,r,o){var h,f,y,v,b;const u=P("Uploader");return c(),_("div",se,[oe,e("form",{onSubmit:s[4]||(s[4]=H((...i)=>o.submit&&o.submit(...i),["prevent"]))},[d(L,{"dense-toggle":"",label:"Student details","header-class":"text-body1 text-weight-bold q-pa-none q-my-sm",ref:"institution_course_details_expansion"},{default:T(()=>{var i,x,g,w,q,M,V,S,D,C,E,k;return[e("div",ie,[e("div",ae,[ne,e("div",re,n((i=o.getMe)==null?void 0:i.first_name),1)]),e("div",de,[le,e("div",ce,n((x=o.getMe)==null?void 0:x.last_name),1)])]),d(p,{class:"q-my-xs"}),e("div",_e,[e("div",pe,[me,e("div",ue,n((g=o.getMe)==null?void 0:g.phone_number),1)]),e("div",he,[fe,e("div",ye,n((w=o.getMe)==null?void 0:w.email),1)])]),d(p,{class:"q-my-xs"}),e("div",ve,[e("div",be,[xe,e("div",ge,n((M=(q=o.getMe)==null?void 0:q.student_details)==null?void 0:M.institution),1)]),e("div",we,[qe,e("div",Me,n((S=(V=o.getMe)==null?void 0:V.student_details)==null?void 0:S.year_of_admission),1)])]),d(p,{class:"q-my-xs"}),e("div",Ve,[e("div",Se,[De,e("div",Ce,n((C=(D=o.getMe)==null?void 0:D.student_details)==null?void 0:C.course),1)]),e("div",Ee,[ke,e("div",je,n((k=(E=o.getMe)==null?void 0:E.student_details)==null?void 0:k.year_of_admission),1)])])]}),_:1},512),e("div",Ue,[Oe,e("div",Qe,[e("div",ze,[Fe,d(Z,{dense:"",outlined:"",modelValue:r.form.opportunity_type,"onUpdate:modelValue":s[0]||(s[0]=i=>r.form.opportunity_type=i),type:"number",options:["internship","job"],"popup-content-class":"selection-options"},null,8,["modelValue"]),(h=a.v$.form)!=null&&h.opportunity_type.$error?(c(),_("div",Ne,n((f=a.v$.form)==null?void 0:f.opportunity_type.$errors[0].$message),1)):U("",!0)]),O(e("div",Ae,[Be,O(e("input",{type:"date",class:"date-input","onUpdate:modelValue":s[1]||(s[1]=i=>r.form.internship_start_date=i),min:o.minDate},null,8,Ie),[[R,r.form.internship_start_date]])],512),[[Y,r.form.opportunity_type==="internship"]])]),e("div",Je,[Pe,d($,{outlined:"",modelValue:r.form.about_the_applicant,"onUpdate:modelValue":s[2]||(s[2]=i=>r.form.about_the_applicant=i),type:"textarea"},null,8,["modelValue"]),(y=a.v$.form)!=null&&y.about_the_applicant.$error?(c(),_("div",Te,n((v=a.v$.form)==null?void 0:v.about_the_applicant.$errors[0].$message),1)):U("",!0)]),e("div",Ye,[Re,d(u,{uploaded_file_name:(b=l.resume)==null?void 0:b.resume_file_name,onSelected_file_emitted_event:o.handleCVFile},null,8,["uploaded_file_name","onSelected_file_emitted_event"])])]),e("div",$e,[d(Q,{outline:"",label:"back",onClick:s[3]||(s[3]=i=>t.$router.go(-1)),"no-caps":""}),d(Q,{outline:"",label:"submit",type:"submit","no-caps":""})])],32)])}var dt=N(te,[["render",He]]);export{dt as default};
