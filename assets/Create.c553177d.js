import{Q as y}from"./QSelect.9a553155.js";import{_ as D,Z as J,a8 as B,aa as G,a1 as m,a2 as a,ad as s,d as n,ai as c,a5 as f,ah as d,aj as E,J as b,af as p,ae as Q,ak as O}from"./index.58c24f9b.js";import{u as W}from"./index.0927d919.js";import{c as u,r as _}from"./index.2b518934.js";import{u as j,g as C,p as I,r as L}from"./generateHeaders.1afc8456.js";import{u as T}from"./auth_user_store.67764a02.js";import"./QItemLabel.e80a075a.js";import"./QMenu.635eb69f.js";import"./position-engine.3cd62232.js";import"./selection.0047419f.js";import"./format.a33550d6.js";import"./axios.5abb35e7.js";const{getSettings:A}=J(j()),{getMe:P}=J(T()),R={setup(){return{v$:W()}},data(){return{form:{school:null,number_of_classes:void 0,number_of_students_per_class:void 0,number_of_teachers:void 0,school_has_labs:!1,number_of_labs:void 0,student_gender:null,number_of_boys_toilets:void 0,number_of_girls_toilets:void 0,number_of_teachers_toilets:void 0,school_has_water_source:!1,types_of_water_sources:null,number_of_desks:void 0,number_of_chairs:void 0,number_of_lockers:void 0},school_list:[]}},validations(){return{form:{school:{required:u.withMessage("School is required",_)},number_of_classes:{required:u.withMessage("Number of classes is required",_)},number_of_students_per_class:{required:u.withMessage("Number of students per class is required",_)},number_of_teachers:{required:u.withMessage("Number of teachers is required",_)},number_of_teachers_toilets:{required:u.withMessage("Number of teachers is required",_)},number_of_teachers_toilets:{required:u.withMessage("Number of teachers toilets is required",_)},student_gender:{required:u.withMessage("Student gender composition is required",_)}}}},computed:{encryptionEnabled(){var t;return(t=A.value)==null?void 0:t.api_encryption_enabled},secondarySchools(){return this.school_list.map(t=>({label:t.name_of_school,value:t.school_serial_number,id:t.id,gender_of_school:t.gender_of_school}))},schoolHasGirls(){return this.form.student_gender==="girls"||this.form.student_gender==="mixed"?!0:(this.form.number_of_girls_toilets=0,!1)},schoolHasBoys(){return this.form.student_gender==="boys"||this.form.student_gender==="mixed"?!0:(this.form.number_of_boys_toilets=0,!1)},waterSources(){return["borehole","well","spring","piped water"]}},mounted(){this.fetchSchools()},methods:{handleSchoolHasLab(t){t||(this.form.number_of_labs=void 0)},handleSchoolHasWaterSource(t){t||(this.form.type_of_water_source=null)},handleSelectedSchool(t){this.form.student_gender=t.gender_of_school},async fetchSchools(t={}){try{let h=(await this.$api.get("/api/v1/school-heads/schools-list/",{headers:{...C()}})).data;this.encryptionEnabled&&(h=JSON.parse(B(h)));const{message:l,success:o,results:i}=h;this.school_list=i}catch{}},async submit(){var t;try{if(this.v$.$touch(),this.v$.$error)return;let e={...this.form};e.school_serial_number=this.form.school.value,e.school=this.form.school.id,e.current_school_head=(t=P.value)==null?void 0:t.id,e.name_of_school=this.form.school.label,e.type_of_school="tvet",this.encryptionEnabled&&(e=G(JSON.stringify(e)));let l=(await this.$api.post("/api/v1/school-heads/schools/update/",e,{headers:{...C()}})).data;this.encryptionEnabled&&(l=JSON.parse(B(l)));const{message:o,success:i,results:v}=l;I({message:o}),this.$router.go(-1)}catch(e){L({caller:"update school details form",error:e,api_encryption_enabled:this.encryptionEnabled})}}}},Z={class:"form-container"},z=s("div",{class:"text-h6 text-center"},"Institution details",-1),F={class:"row"},K={class:"col-md-6 col-xs-12 q-pa-sm"},X={class:"q-my-xs"},Y=s("div",{class:"form-lable"},"School *",-1),$={key:0,class:"text-red"},ee={class:"q-my-xs"},se=s("div",{class:"form-lable"},"Number of classes *",-1),oe={key:0,class:"text-red"},re={class:"q-my-xs"},te=s("div",{class:"form-lable"},"Number of students per class *",-1),le={key:0,class:"text-red"},ne={class:"q-my-xs"},ie=s("div",{class:"form-lable"},"Number of teachers *",-1),de={key:0,class:"text-red"},me={class:"q-mt-sm"},ae={class:"q-my-xs"},ue=s("div",{class:"form-lable"},"Number of labs *",-1),_e={class:"col-md-6 col-xs-12 q-pa-sm"},ce={class:"q-my-xs"},fe=s("div",{class:"form-lable"},"Number of teachers toilets *",-1),he={key:0,class:"text-red"},be={class:"q-my-xs"},pe=s("div",{class:"form-lable"},"Gender *",-1),ve={key:0,class:"text-red"},ye={class:"q-my-xs"},Ve=s("div",{class:"form-lable"},"Number of girls toilets *",-1),ge={class:"q-my-xs"},qe=s("div",{class:"form-lable"},"Number of boys toilets *",-1),Se={class:"q-ma-sm"},xe=s("div",{class:"text-center text-subtitle2"},"Water source",-1),we={class:""},ke={class:"q-my-xs"},Ne=s("div",{class:"form-lable"},"Types of water sources *",-1),Ue={class:"q-ma-md"},He=s("div",{class:"text-center text-subtitle2"},"Desks, lockers and chairs",-1),Me={class:"q-my-sm"},Be=s("div",{class:"form-lable"},"Number of desks *",-1),Ee={class:"q-my-sm"},Qe=s("div",{class:"form-lable"},"Number of lockers *",-1),Ce={class:"q-my-sm"},Je=s("div",{class:"form-lable"},"Number of chairs *",-1),De={class:"flex justify-between q-ma-md"};function Ge(t,e,h,l,o,i){var v,V,g,q,S,x,w,k,N,U,H,M;return m(),a("div",Z,[z,s("form",{onSubmit:e[16]||(e[16]=O((...r)=>i.submit&&i.submit(...r),["prevent"]))},[s("div",F,[s("div",K,[s("div",X,[Y,n(y,{dense:"",outlined:"",modelValue:o.form.school,"onUpdate:modelValue":[e[0]||(e[0]=r=>o.form.school=r),i.handleSelectedSchool],options:i.secondarySchools,"popup-content-class":"selection-options"},null,8,["modelValue","options","onUpdate:modelValue"]),(v=l.v$.form)!=null&&v.school.$error?(m(),a("div",$,c((V=l.v$.form)==null?void 0:V.school.$errors[0].$message),1)):f("",!0)]),s("div",ee,[se,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_classes,"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.number_of_classes=r),type:"number"},null,8,["modelValue"]),(g=l.v$.form)!=null&&g.number_of_classes.$error?(m(),a("div",oe,c((q=l.v$.form)==null?void 0:q.number_of_classes.$errors[0].$message),1)):f("",!0)]),s("div",re,[te,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_students_per_class,"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.number_of_students_per_class=r),type:"number"},null,8,["modelValue"]),(S=l.v$.form)!=null&&S.number_of_students_per_class.$error?(m(),a("div",le,c((x=l.v$.form)==null?void 0:x.number_of_students_per_class.$errors[0].$message),1)):f("",!0)]),s("div",ne,[ie,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_teachers,"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.number_of_teachers=r),type:"number"},null,8,["modelValue"]),(w=l.v$.form)!=null&&w.number_of_teachers.$error?(m(),a("div",de,c((k=l.v$.form)==null?void 0:k.number_of_teachers.$errors[0].$message),1)):f("",!0)]),s("div",me,[n(E,{dense:"",outlined:"",modelValue:o.form.school_has_labs,"onUpdate:modelValue":[e[4]||(e[4]=r=>o.form.school_has_labs=r),i.handleSchoolHasLab],label:"School has lab(s)"},null,8,["modelValue","onUpdate:modelValue"])]),b(s("div",ae,[ue,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_labs,"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.number_of_labs=r),type:"number"},null,8,["modelValue"])],512),[[p,o.form.school_has_labs]])]),s("div",_e,[s("div",ce,[fe,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_teachers_toilets,"onUpdate:modelValue":e[6]||(e[6]=r=>o.form.number_of_teachers_toilets=r),type:"number"},null,8,["modelValue"]),(N=l.v$.form)!=null&&N.number_of_teachers_toilets.$error?(m(),a("div",he,c((U=l.v$.form)==null?void 0:U.number_of_teachers_toilets.$errors[0].$message),1)):f("",!0)]),s("div",be,[pe,n(y,{dense:"",outlined:"",modelValue:o.form.student_gender,"onUpdate:modelValue":e[7]||(e[7]=r=>o.form.student_gender=r),options:["boys","girls","mixed"],"popup-content-class":"selection-options"},null,8,["modelValue"]),(H=l.v$.form)!=null&&H.student_gender.$error?(m(),a("div",ve,c((M=l.v$.form)==null?void 0:M.student_gender.$errors[0].$message),1)):f("",!0)]),b(s("div",ye,[Ve,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_girls_toilets,"onUpdate:modelValue":e[8]||(e[8]=r=>o.form.number_of_girls_toilets=r),type:"number"},null,8,["modelValue"])],512),[[p,i.schoolHasGirls]]),b(s("div",ge,[qe,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_boys_toilets,"onUpdate:modelValue":e[9]||(e[9]=r=>o.form.number_of_boys_toilets=r),type:"number"},null,8,["modelValue"])],512),[[p,i.schoolHasBoys]])])]),s("div",Se,[xe,s("div",we,[n(E,{dense:"",outlined:"",modelValue:o.form.school_has_water_source,"onUpdate:modelValue":[e[10]||(e[10]=r=>o.form.school_has_water_source=r),i.handleSchoolHasWaterSource],label:"School has water source"},null,8,["modelValue","onUpdate:modelValue"])]),b(s("div",ke,[Ne,n(y,{dense:"",outlined:"",modelValue:o.form.types_of_water_sources,"onUpdate:modelValue":e[11]||(e[11]=r=>o.form.types_of_water_sources=r),"use-input":"","use-chips":"",multiple:"",options:i.waterSources,"popup-content-class":"selection-options"},null,8,["modelValue","options"])],512),[[p,o.form.school_has_water_source]])]),s("div",Ue,[He,s("div",Me,[Be,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_desks,"onUpdate:modelValue":e[12]||(e[12]=r=>o.form.number_of_desks=r),type:"number"},null,8,["modelValue"])]),s("div",Ee,[Qe,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_lockers,"onUpdate:modelValue":e[13]||(e[13]=r=>o.form.number_of_lockers=r),type:"number"},null,8,["modelValue"])]),s("div",Ce,[Je,n(d,{dense:"",outlined:"",modelValue:o.form.number_of_chairs,"onUpdate:modelValue":e[14]||(e[14]=r=>o.form.number_of_chairs=r),type:"number"},null,8,["modelValue"])])]),s("div",De,[n(Q,{outline:"",label:"Back",onClick:e[15]||(e[15]=r=>t.$router.go(-1)),"no-caps":""}),n(Q,{outline:"",label:"Submit",type:"submit","no-caps":""})])],32)])}var Ke=D(R,[["render",Ge]]);export{Ke as default};
