import{_ as S,Z as k,a8 as N,a1 as h,a2 as f,ad as t,d as o,ah as A,a3 as _,b2 as d,ae as u,ai as c,J as m,af as g,as as w,F as C,b5 as I,b3 as T,b4 as V}from"./index.bacfec48.js";import{Q as z}from"./QTooltip.8a56dee4.js";import{b as M}from"./axios.a3b240ae.js";import{u as P,g as D}from"./generateHeaders.c61a8e24.js";import"./auth_user_store.fb6dbab9.js";import"./position-engine.bab6871e.js";import"./selection.0f6ce218.js";const{getSettings:L}=k(P()),Q={data(){return{response_data:"",all_docs:[],table_docs:[],search_term:"",cancelToken:void 0,sort_ASC:!0}},computed:{encryptionEnabled(){var s;return(s=L.value)==null?void 0:s.api_encryption_enabled},schoolHeads(){return this.table_docs.map(s=>({...s}))}},mounted(){this.fetchMany(),this.setupPagination()},methods:{async fetchMany(s={}){try{typeof this.cancelToken!="undefined"&&this.cancelToken.cancel("Operation canceled due to new request."),this.cancelToken=M.CancelToken.source();let n=(await this.$api.get("/api/v1/admin/school-heads/",{headers:{...D()},cancelToken:this.cancelToken.token,params:s})).data;this.encryptionEnabled&&(n=JSON.parse(N(n)));const{message:p,success:r,results:i}=n;this.response_data=i,this.all_docs=this.response_data.docs,this.table_docs=this.all_docs}catch{}},setupPagination(){const s=document.querySelector(".trigger");new IntersectionObserver(([n])=>{var p;console.log("entry.isIntersecting ================ ",n.isIntersecting),!!this.response_data&&n.isIntersecting&&this.fetchNext((p=this.response_data)==null?void 0:p.nextPage)},{root:null,threshold:0}).observe(s)},fetchNext(s){!this.response_data.nextPage||this.response_data.page>=s||this.fetchMany({page:s,size:this.response_data.limit,search_term:this.search_term})},filterData(s){s=s.trim(),this.fetchMany({search_term:s})},sortList(s){this.sort_ASC?(this.table_docs.sort((a,n)=>a[s]>n[s]?-1:1),this.sort_ASC=!1):(this.table_docs.sort((a,n)=>a[s]<n[s]?-1:1),this.sort_ASC=!0)}}},l=s=>(T("data-v-17ab56c4"),s=s(),V(),s),q={class:""},B={class:"flex justify-between q-my-sm data-table-top"},E={class:"flex",style:{gap:"5px"}},F={class:"flex",style:{gap:"0px 5px"}},O={class:"q-px-sm text-grey text-h6"},U={class:""},j=l(()=>t("th",{scope:"col"},"First name",-1)),G=l(()=>t("th",{scope:"col"},"Last name",-1)),J=l(()=>t("th",{scope:"col"},"phone_number",-1)),R=l(()=>t("th",{scope:"col"},"School type",-1)),Z=l(()=>t("th",{scope:"col"},"School",-1)),K={scope:"col"},W=l(()=>t("th",{scope:"col"},"Actions",-1)),X={"data-label":"First name",class:"text-capitalize"},Y={"data-label":"Last name",class:"text-capitalize"},$={"data-label":"Phone number",class:"text-capitalize"},H={"data-label":"School type",class:"text-capitalize"},ee={"data-label":"Updated",class:"text-capitalize"},te={"data-label":"Gender",class:"text-capitalize"},se={"data-label":"Action"},ae={class:"flex justify-center items-center",style:{gap:"5px"}},ne=l(()=>t("span",{class:"trigger"},null,-1)),re=l(()=>t("div",{class:"text-left"},"No school heads ",-1)),ie=[re];function oe(s,a,n,p,r,i){var b,x,y;return h(),f("div",q,[t("div",B,[t("div",E,[o(A,{modelValue:r.search_term,"onUpdate:modelValue":[a[0]||(a[0]=e=>r.search_term=e),i.filterData],placeholder:"search",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),o(u,{outline:"",color:"grey-5",dense:"",icon:"refresh",onClick:i.fetchMany},{default:_(()=>[o(z,null,{default:_(()=>[d(" Refresh ")]),_:1})]),_:1},8,["onClick"])]),t("div",F,[t("span",O,c((b=r.all_docs)==null?void 0:b.length)+" of "+c((x=r.response_data)==null?void 0:x.totalDocs),1),m(o(u,{outline:"",outlined:"",color:"grey-5",onClick:a[1]||(a[1]=e=>{var v;return i.fetchNext((v=r.response_data)==null?void 0:v.nextPage)}),"no-caps":""},{default:_(()=>[d("Next")]),_:1},512),[[g,(y=r.response_data)==null?void 0:y.nextPage]])])]),t("table",U,[t("thead",null,[t("tr",null,[j,G,J,R,Z,t("th",K,[t("div",{class:"sortable-table-head",onClick:a[2]||(a[2]=e=>i.sortList("student_gender"))},[d(" Gender "),o(w,{name:"arrow_downward"}),o(w,{name:"arrow_upward"})])]),W])]),m(t("tbody",null,[(h(!0),f(C,null,I(i.schoolHeads,e=>(h(),f("tr",{key:e==null?void 0:e.id},[t("td",X,c((e==null?void 0:e.first_name)||"N/A"),1),t("td",Y,c(e==null?void 0:e.last_name),1),t("td",$,c((e==null?void 0:e.phone_number)||"N/A"),1),t("td",H,c((e==null?void 0:e.type_of_school)||"N/A"),1),t("td",ee,c((e==null?void 0:e.name_of_school)||"N/A"),1),t("td",te,c((e==null?void 0:e.student_gender)||"N/A"),1),t("td",se,[t("div",ae,[o(u,{unelevated:"","no-caps":"",dense:"",color:"orange",style:{"min-width":"40px"},to:`/school-heads/view/${e==null?void 0:e.id}`},{default:_(()=>[d("View")]),_:2},1032,["to"]),o(u,{unelevated:"","no-caps":"",dense:"",color:"green",style:{"min-width":"40px"},to:`/school-heads/edit/${e==null?void 0:e.id}`},{default:_(()=>[d("Edit")]),_:2},1032,["to"])])])]))),128))],512),[[g,i.schoolHeads]]),ne,m(t("div",null,ie,512),[[g,!r.table_docs.length]])])])}var fe=S(Q,[["render",oe],["__scopeId","data-v-17ab56c4"]]);export{fe as default};
