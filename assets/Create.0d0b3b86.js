import{Q as h}from"./QSelect.9a553155.js";import{_ as U,Z as M,aa as E,a8 as N,a1 as i,a2 as d,ad as s,d as n,ai as m,a5 as u,ah as p,ae as $,ak as B}from"./index.58c24f9b.js";import{u as C}from"./index.0927d919.js";import{c,r as _}from"./index.2b518934.js";import{u as Q,g as O,p as T,r as j}from"./generateHeaders.1afc8456.js";import{u as G}from"./auth_user_store.67764a02.js";import"./QItemLabel.e80a075a.js";import"./QMenu.635eb69f.js";import"./position-engine.3cd62232.js";import"./selection.0047419f.js";import"./format.a33550d6.js";import"./axios.5abb35e7.js";M(G());const{getSettings:J}=M(Q()),P={setup(){return{v$:C()}},data(){return{form:{ward:null,name_of_school:null,type_of_school:null,gender_of_school:null,school_serial_number:null},lat:null,lon:null}},computed:{encryptionEnabled(){var l;return(l=J.value)==null?void 0:l.api_encryption_enabled},locations(){return[{label:"ward 1",value:"location_1"},{label:"ward 2",value:"location_2"}]},schoolTypes(){return[{label:"Primary",value:"primary"},{label:"Secondary",value:"secondary"}]},genders(){return[{label:"Boys",value:"boys"},{label:"Girls",value:"girls"},{label:"Mixed",value:"mixed"}]}},validations(){return{form:{ward:{required:c.withMessage("Ward is required",_)},type_of_school:{required:c.withMessage("Select whether school is primary or secondary",_)},gender_of_school:{required:c.withMessage("School gender is required",_)},name_of_school:{required:c.withMessage("School name is required",_)},school_serial_number:{required:c.withMessage("School serial number is required",_)}}}},mounted(){},methods:{async submit(){try{if(this.v$.$touch(),this.v$.$error)return;let l={...this.form};l.gender_of_school=this.form.gender_of_school.value,l.ward=this.form.ward.value,l.type_of_school=this.form.type_of_school.value,this.lat&&this.lon&&(l.coordinates=[this.lat,this.lon]),this.encryptionEnabled&&(l=E(JSON.stringify(l)));let f=(await this.$api.post("/api/v1/admin/schools/create/",l,{headers:{...O()}})).data;this.encryptionEnabled&&(f=JSON.parse(N(f)));const{message:t,success:r,results:a}=f;T({message:t}),this.$router.go(-1)}catch(l){j({caller:"create school admin",error:l,api_encryption_enabled:this.encryptionEnabled})}}}},W={class:"form-container"},A=s("div",{class:"text-h6 text-center"},"New school",-1),D={class:"q-my-xs"},H=s("div",{class:"form-lable"},"Ward *",-1),I={key:0,class:"text-red"},R={class:"q-my-xs"},Z=s("div",{class:"form-lable"},"Name *",-1),z={key:0,class:"text-red"},F={class:"q-my-xs"},K=s("div",{class:"form-lable"}," MOE registration number *",-1),L={key:0,class:"text-red"},X={class:"q-my-xs"},Y=s("div",{class:"form-lable"},"School type *",-1),ee={key:0,class:"text-red"},oe={class:"q-my-xs"},se=s("div",{class:"form-lable"},"Gender *",-1),re={key:0,class:"text-red"},le={class:"q-my-xs"},te=s("div",{class:"form-lable"},"Coordinates ",-1),ne={class:"flex justify-between"},ae={class:"flex justify-between q-mt-lg"};function ie(l,e,f,t,r,a){var v,y,b,g,V,w,x,q,S,k;return i(),d("div",W,[A,s("form",{onSubmit:e[8]||(e[8]=B((...o)=>a.submit&&a.submit(...o),["prevent"]))},[s("div",D,[H,n(h,{dense:"",outlined:"",modelValue:r.form.ward,"onUpdate:modelValue":e[0]||(e[0]=o=>r.form.ward=o),options:a.locations,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(v=t.v$.form)!=null&&v.ward.$error?(i(),d("div",I,m((y=t.v$.form)==null?void 0:y.ward.$errors[0].$message),1)):u("",!0)]),s("div",R,[Z,n(p,{dense:"",outlined:"",modelValue:r.form.name_of_school,"onUpdate:modelValue":e[1]||(e[1]=o=>r.form.name_of_school=o)},null,8,["modelValue"]),(b=t.v$.form)!=null&&b.name_of_school.$error?(i(),d("div",z,m((g=t.v$.form)==null?void 0:g.name_of_school.$errors[0].$message),1)):u("",!0)]),s("div",F,[K,n(p,{dense:"",outlined:"",modelValue:r.form.school_serial_number,"onUpdate:modelValue":e[2]||(e[2]=o=>r.form.school_serial_number=o)},null,8,["modelValue"]),(V=t.v$.form)!=null&&V.school_serial_number.$error?(i(),d("div",L,m((w=t.v$.form)==null?void 0:w.school_serial_number.$errors[0].$message),1)):u("",!0)]),s("div",X,[Y,n(h,{dense:"",outlined:"",modelValue:r.form.type_of_school,"onUpdate:modelValue":e[3]||(e[3]=o=>r.form.type_of_school=o),options:a.schoolTypes,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(x=t.v$.form)!=null&&x.type_of_school.$error?(i(),d("div",ee,m((q=t.v$.form)==null?void 0:q.type_of_school.$errors[0].$message),1)):u("",!0)]),s("div",oe,[se,n(h,{dense:"",outlined:"",modelValue:r.form.gender_of_school,"onUpdate:modelValue":e[4]||(e[4]=o=>r.form.gender_of_school=o),options:a.genders,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(S=t.v$.form)!=null&&S.gender_of_school.$error?(i(),d("div",re,m((k=t.v$.form)==null?void 0:k.gender_of_school.$errors[0].$message),1)):u("",!0)]),s("div",le,[te,s("div",ne,[n(p,{dense:"",outlined:"",modelValue:r.lat,"onUpdate:modelValue":e[5]||(e[5]=o=>r.lat=o),placeholder:"latitude",type:"number",step:".000001"},null,8,["modelValue"]),n(p,{dense:"",outlined:"",modelValue:r.lon,"onUpdate:modelValue":e[6]||(e[6]=o=>r.lon=o),placeholder:"longitude",type:"number",step:".0000001"},null,8,["modelValue"])])]),s("div",ae,[n($,{outline:"",label:"Back",onClick:e[7]||(e[7]=o=>l.$router.go(-1)),"no-caps":"",style:{"min-width":"100px"}}),n($,{unelevated:"",color:"primary",label:"Submit",type:"submit","no-caps":"",style:{"min-width":"100px"}})])],32)])}var Ve=U(P,[["render",ie]]);export{Ve as default};
