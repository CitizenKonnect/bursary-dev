import{_ as A,Z as O,$,a6 as B,aa as I,a8 as U,a0 as J,a1 as c,a2 as _,ad as e,d,a3 as P,ai as n,aM as u,a5 as h,J as Q,af as T,b6 as Y,ah as R,ae as j,ak as H}from"./index.56aced16.js";import{Q as L}from"./QExpansionItem.2f2a2c84.js";import{Q as Z}from"./QSelect.1fc42082.js";import{u as G}from"./index.62701558.js";import{c as p}from"./index.33746749.js";import{g as z,p as K,r as F}from"./generateHeaders.891fe619.js";import{u as W}from"./auth_user_store.0a1df304.js";import{f as X}from"./index.e3cc403f.js";import"./QItemLabel.cffd16e9.js";import"./QMenu.58a91336.js";import"./position-engine.9dfbd25a.js";import"./selection.e4c60947.js";import"./format.a33550d6.js";import"./axios.af9b5afd.js";const{getMe:N}=O(W()),ee={setup(){return{v$:G()}},data(){return{form:{opportunity_type:null,about_the_applicant:null,internship_start_date:null},resume_upload:null}},validations(){return{form:{opportunity_type:{required:p.withMessage("Opportunity type is required",t=>!!t)},about_the_applicant:{required:p.withMessage("Your description is required",t=>!!t),min_length:p.withMessage("Your description must be atleast 50 words",t=>!((t==null?void 0:t.length)<=100))}},resume_upload:{required:p.withMessage("CV is required",t=>!!t)}}},computed:{minDate(){const t=new Date;return X(t,"yyy-MM-dd")},getMe(){return N.value}},components:{Uploader:$(()=>B(()=>import("./Uploader.7a98de9c.js"),["assets/Uploader.7a98de9c.js","assets/index.56aced16.js","assets/index.93ddf4f0.css"]))},methods:{handleCVFile(t){this.resume_upload=t},async submit(){try{if(this.v$.$touch(),this.v$.$error)return;let t={...this.form,user:N.value.id};this.encryptionEnabled&&(t=I(JSON.stringify(t)));let l=(await this.$api.post("/api/v1/resumes/apply/",t,{headers:{...z()}})).data;this.encryptionEnabled&&(l=JSON.parse(U(l)));const{message:i,success:r,results:o}=l;if(!await this.uploadDocument({resume_id:o.id}))return;K({message:i}),this.$router.go(-1)}catch(t){F({caller:"Application",error:t,api_encryption_enabled:this.api_encryption_enabled})}},async uploadDocument({resume_id:t}){try{const s=new FormData;s.append("resume_id",t),s.append("applicant_cv",this.resume_upload.file);let i=(await this.$api.post("/api/v1/resumes/upload/",s,{headers:{...z(),"Content-Type":"multipart/form-data"}})).data;this.encryptionEnabled&&(i=JSON.parse(U(i)));const{message:r,success:o,results:m}=i;return!0}catch(s){return F({caller:"document upload",error:s,api_encryption_enabled:this.api_encryption_enabled}),!1}}}},te={class:"form-container"},se=e("div",{class:"text-center text-h6 q-mb-md"},"Application",-1),oe={class:"flex justify-between"},ie={class:"q-pa-none"},ae=e("div",{class:"text-weight-bold"},"First name",-1),ne={class:"text-capitalize"},re={class:"q-pa-none",style:{"min-width":"150px"}},de=e("div",{class:"text-weight-bold"},"First name",-1),le={class:"text-capitalize"},ce={class:"flex justify-between"},_e={class:"q-pa-none"},pe=e("div",{class:"text-weight-bold"},"Phone number",-1),me={class:""},ue={class:"q-pa-none",style:{"min-width":"150px"}},he=e("div",{class:"text-weight-bold"},"Email",-1),fe={class:""},ye={class:"flex justify-between"},ve={class:"q-pa-none"},xe=e("div",{class:"text-weight-bold"},"Institution ",-1),be={class:"text-capitalize"},ge={class:"q-pa-none",style:{"min-width":"150px"}},we=e("div",{class:"text-weight-bold"},"Year of admission",-1),qe={class:"text-capitalize"},Me={class:"flex justify-between"},Ve={class:"q-pa-none"},Se=e("div",{class:"text-weight-bold"},"Course ",-1),Ce={class:"text-capitalize"},De={class:"q-pa-none",style:{"min-width":"150px"}},Ee=e("div",{class:"text-weight-bold"},"Year of admission",-1),ke={class:"text-capitalize"},Ue={class:"form-fields q-mt-md"},Qe=e("div",{class:"text-center text-h6"},"Fill the form below",-1),je={class:"row",style:{gap:"10px"}},ze={class:"col-sm-grow col-xs-12"},Fe=e("div",{class:"q-my-xs"},"Select type of opportunity*",-1),Ne={key:0,class:"text-red"},Ae={class:"col-sm-grow col-xs-12"},Oe=e("div",{class:"q-my-xs"},"Starting date",-1),$e=["min"],Be={class:"q-my-sm"},Ie=e("div",{class:"q-my-xs"},"Describe yourself*",-1),Je={key:0,class:"text-red"},Pe={class:"q-my-sm"},Te=e("div",{class:""},"Upload CV*",-1),Ye={key:0,class:"text-red"},Re={class:"flex justify-between q-mt-md"};function He(t,s,l,i,r,o){var f,y,v,x;const m=J("Uploader");return c(),_("div",te,[se,e("form",{onSubmit:s[4]||(s[4]=H((...a)=>o.submit&&o.submit(...a),["prevent"]))},[d(L,{"dense-toggle":"",label:"Student details","header-class":"text-body1 text-weight-bold q-pa-none q-my-sm",ref:"institution_course_details_expansion"},{default:P(()=>{var a,b,g,w,q,M,V,S,C,D,E,k;return[e("div",oe,[e("div",ie,[ae,e("div",ne,n((a=o.getMe)==null?void 0:a.first_name),1)]),e("div",re,[de,e("div",le,n((b=o.getMe)==null?void 0:b.last_name),1)])]),d(u,{class:"q-my-xs"}),e("div",ce,[e("div",_e,[pe,e("div",me,n((g=o.getMe)==null?void 0:g.phone_number),1)]),e("div",ue,[he,e("div",fe,n((w=o.getMe)==null?void 0:w.email),1)])]),d(u,{class:"q-my-xs"}),e("div",ye,[e("div",ve,[xe,e("div",be,n((M=(q=o.getMe)==null?void 0:q.student_details)==null?void 0:M.institution),1)]),e("div",ge,[we,e("div",qe,n((S=(V=o.getMe)==null?void 0:V.student_details)==null?void 0:S.year_of_admission),1)])]),d(u,{class:"q-my-xs"}),e("div",Me,[e("div",Ve,[Se,e("div",Ce,n((D=(C=o.getMe)==null?void 0:C.student_details)==null?void 0:D.course),1)]),e("div",De,[Ee,e("div",ke,n((k=(E=o.getMe)==null?void 0:E.student_details)==null?void 0:k.year_of_admission),1)])])]}),_:1},512),e("div",Ue,[Qe,e("div",je,[e("div",ze,[Fe,d(Z,{dense:"",outlined:"",modelValue:r.form.opportunity_type,"onUpdate:modelValue":s[0]||(s[0]=a=>r.form.opportunity_type=a),type:"number",options:["internship","job"],"popup-content-class":"selection-options"},null,8,["modelValue"]),(f=i.v$.form)!=null&&f.opportunity_type.$error?(c(),_("div",Ne,n((y=i.v$.form)==null?void 0:y.opportunity_type.$errors[0].$message),1)):h("",!0)]),Q(e("div",Ae,[Oe,Q(e("input",{type:"date",class:"date-input","onUpdate:modelValue":s[1]||(s[1]=a=>r.form.internship_start_date=a),min:o.minDate},null,8,$e),[[Y,r.form.internship_start_date]])],512),[[T,r.form.opportunity_type==="internship"]])]),e("div",Be,[Ie,d(R,{outlined:"",modelValue:r.form.about_the_applicant,"onUpdate:modelValue":s[2]||(s[2]=a=>r.form.about_the_applicant=a),type:"textarea"},null,8,["modelValue"]),(v=i.v$.form)!=null&&v.about_the_applicant.$error?(c(),_("div",Je,n((x=i.v$.form)==null?void 0:x.about_the_applicant.$errors[0].$message),1)):h("",!0)]),e("div",Pe,[Te,d(m,{onSelected_file_emitted_event:o.handleCVFile},null,8,["onSelected_file_emitted_event"]),i.v$.resume_upload.$error?(c(),_("div",Ye,n(i.v$.resume_upload.$errors[0].$message),1)):h("",!0)])]),e("div",Re,[d(j,{outline:"",label:"back",onClick:s[3]||(s[3]=a=>t.$router.go(-1)),"no-caps":""}),d(j,{outline:"",label:"submit",type:"submit","no-caps":""})])],32)])}var dt=A(ee,[["render",He]]);export{dt as default};
