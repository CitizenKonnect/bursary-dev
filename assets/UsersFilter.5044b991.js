import{b as h,Q as _,a as m}from"./QItemLabel.74f9032e.js";import{Q as f}from"./QSelect.0b2e4f76.js";import{b as g}from"./axios.a3b240ae.js";import{_ as b,Z as y,a8 as S,a1 as x,a2 as k,d as l,a3 as i,bt as v,bR as T,b2 as w,ai as c,ad as u}from"./index.bacfec48.js";import{u as V,g as Q}from"./generateHeaders.c61a8e24.js";import"./QMenu.7f6159df.js";import"./position-engine.bab6871e.js";import"./selection.0f6ce218.js";import"./format.a33550d6.js";import"./auth_user_store.fb6dbab9.js";const{getSettings:N}=y(V()),C={data(){return{selected_user:"",search_results:[],cancelToken:void 0,all_records:[]}},computed:{encryptionEnabled(){var e;return(e=N.value)==null?void 0:e.api_encryption_enabled}},methods:{async fetchOptions(e,t){var r;if(e===""){this.search_results=this.all_records,t();return}const n=await this.apiSearch(e);if(!!(n!=null&&n.success)){if(this.search_results=(r=n.results)==null?void 0:r.map(s=>({...s,label:s.first_name+" "+s.last_name})),this.all_records=this.search_results,this.search_results.length)return t();t()}},handleSelection(e){!e||this.$emit("selected_value_emitted",e)},clearSelection(){this.search_term=null,this.$emit("clear_selected_value",!0)},async apiSearch(e){try{if(e.length<2)return;typeof this.cancelToken!="undefined"&&this.cancelToken.cancel("Operation canceled due to new request."),this.cancelToken=g.CancelToken.source();const t={search_term:e};this.owner&&(t.owner=this.owner);let r=(await this.$api.get("/api/v1/users/search/",{hide_loading_progress:!0,cancelToken:this.cancelToken.token,headers:{...Q()},params:t})).data;this.encryptionEnabled&&(r=JSON.parse(S(r)));const{message:s,success:o,results:a}=r;return{results:a,success:!0}}catch{return{success:!1}}}}},E={class:"",style:{gap:"10px"}},O={class:"text-grey text-caption"},P={class:"text-grey text-caption"};function B(e,t,n,r,s,o){return x(),k("div",null,[l(f,{outlined:"",modelValue:s.selected_user,"onUpdate:modelValue":[t[0]||(t[0]=a=>s.selected_user=a),o.handleSelection],dense:"",options:s.search_results,"use-input":"",clearable:"",onClear:o.clearSelection,onFilter:o.fetchOptions},{option:i(a=>[l(h,v(T(a.itemProps)),{default:i(()=>[l(_,null,{default:i(()=>{var d,p;return[l(m,{class:"text-capitalize"},{default:i(()=>[w(c(a.opt.label),1)]),_:2},1024),u("div",E,[u("div",O,"Email:"+c((d=a.opt)==null?void 0:d.email),1),u("div",P," Phone number:"+c(((p=a.opt)==null?void 0:p.phone_number)||"N/A"),1)])]}),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","onClear","onFilter","onUpdate:modelValue"])])}var L=b(C,[["render",B]]);export{L as default};
