import{Q as v}from"./QSelect.0b2e4f76.js";import{_ as M,Z as N,a8 as U,aa as B,a1 as d,a2 as m,ad as o,ak as Q,d as i,ai as u,a5 as _,ah as y,aj as j,ae as $}from"./index.bacfec48.js";import{u as C}from"./index.91f2720f.js";import{c as h,r as f}from"./index.e03e1fb1.js";import{u as O,g as E,p as D,r as J}from"./generateHeaders.c61a8e24.js";import{u as T}from"./auth_user_store.fb6dbab9.js";import"./QItemLabel.74f9032e.js";import"./QMenu.7f6159df.js";import"./position-engine.bab6871e.js";import"./selection.0f6ce218.js";import"./format.a33550d6.js";import"./axios.a3b240ae.js";N(T());const{getSettings:A}=N(O()),G={setup(){return{v$:C()}},data(){return{form:{location:null,name_of_school:null,type_of_school:null,gender_of_school:null,school_serial_number:null,assigned_to_school_head:!1},school_details:"",lat:null,lon:null}},computed:{encryptionEnabled(){var t;return(t=A.value)==null?void 0:t.api_encryption_enabled},locations(){return["location 1","location 2"]},schoolTypes(){return["primary","secondary"]},genders(){return["boys","girls","mixed"]}},validations(){return{form:{location:{required:h.withMessage("School is required",f)},type_of_school:{required:h.withMessage("Select whether school is primary or secondary",f)},gender_of_school:{required:h.withMessage("School gender is required",f)},name_of_school:{required:h.withMessage("School name is required",f)},school_serial_number:{required:h.withMessage("School serial number is required",f)}}}},mounted(){this.fetchSchoolDetails()},methods:{async fetchSchoolDetails(){try{const t={id:this.$route.params.id};let a=(await this.$api.get("/api/v1/admin/schools/details/",{headers:{...E()},params:t})).data;this.encryptionEnabled&&(a=JSON.parse(U(a)));const{message:r,success:s,results:n}=a;this.school_details=n;for(const[c,p]of Object.entries(this.form))this.form[c]=n[c]||p}catch{}},async submit(){try{if(this.v$.$touch(),this.v$.$error)return;let t={...this.form};t.id=this.school_details.id,this.encryptionEnabled&&(t=B(JSON.stringify(t)));let a=(await this.$api.patch("/api/v1/admin/schools/update/",t,{headers:{...E()}})).data;this.encryptionEnabled&&(a=JSON.parse(U(a)));const{message:r,success:s,results:n}=a;D({message:r}),this.$router.go(-1)}catch(t){console.log("error submitting school details ",t),J({caller:"update school details by  admin",error:t,api_encryption_enabled:this.encryptionEnabled})}}}},H={class:"main-page-height flex flex-center"},I={class:"form-container"},L=o("div",{class:"text-h6 text-center"},"Update school details",-1),P={class:"q-my-xs"},R=o("div",{class:"form-lable"},"Location *",-1),Z={key:0,class:"text-red"},z={class:"q-my-xs"},F=o("div",{class:"form-lable"},"Name *",-1),K={key:0,class:"text-red"},W={class:"q-my-xs"},X=o("div",{class:"form-lable"},"Serial number *",-1),Y={key:0,class:"text-red"},ee={class:"q-my-xs"},oe=o("div",{class:"form-lable"},"School type *",-1),se={key:0,class:"text-red"},le={class:"q-my-xs"},te=o("div",{class:"form-lable"},"Gender *",-1),re={key:0,class:"text-red"},ie={class:"q-my-xs"},ne=o("div",{class:"form-lable"},"Coordinates ",-1),ae={class:"flex justify-between"},de={class:"q-my-md"},me=o("div",{class:"form-lable"},"Assigned to school head ",-1),ce={class:"flex justify-between q-mt-md"};function ue(t,e,a,r,s,n){var c,p,g,b,V,x,S,q,w,k;return d(),m("div",H,[o("div",I,[L,o("form",{onSubmit:e[9]||(e[9]=Q((...l)=>n.submit&&n.submit(...l),["prevent"]))},[o("div",P,[R,i(v,{dense:"",outlined:"",modelValue:s.form.location,"onUpdate:modelValue":e[0]||(e[0]=l=>s.form.location=l),options:n.locations,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(c=r.v$.form)!=null&&c.location.$error?(d(),m("div",Z,u((p=r.v$.form)==null?void 0:p.location.$errors[0].$message),1)):_("",!0)]),o("div",z,[F,i(y,{dense:"",outlined:"",modelValue:s.form.name_of_school,"onUpdate:modelValue":e[1]||(e[1]=l=>s.form.name_of_school=l)},null,8,["modelValue"]),(g=r.v$.form)!=null&&g.name_of_school.$error?(d(),m("div",K,u((b=r.v$.form)==null?void 0:b.name_of_school.$errors[0].$message),1)):_("",!0)]),o("div",W,[X,i(y,{dense:"",outlined:"",modelValue:s.form.school_serial_number,"onUpdate:modelValue":e[2]||(e[2]=l=>s.form.school_serial_number=l)},null,8,["modelValue"]),(V=r.v$.form)!=null&&V.school_serial_number.$error?(d(),m("div",Y,u((x=r.v$.form)==null?void 0:x.school_serial_number.$errors[0].$message),1)):_("",!0)]),o("div",ee,[oe,i(v,{dense:"",outlined:"",modelValue:s.form.type_of_school,"onUpdate:modelValue":e[3]||(e[3]=l=>s.form.type_of_school=l),options:n.schoolTypes,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(S=r.v$.form)!=null&&S.type_of_school.$error?(d(),m("div",se,u((q=r.v$.form)==null?void 0:q.type_of_school.$errors[0].$message),1)):_("",!0)]),o("div",le,[te,i(v,{dense:"",outlined:"",modelValue:s.form.gender_of_school,"onUpdate:modelValue":e[4]||(e[4]=l=>s.form.gender_of_school=l),options:n.genders,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(w=r.v$.form)!=null&&w.gender_of_school.$error?(d(),m("div",re,u((k=r.v$.form)==null?void 0:k.gender_of_school.$errors[0].$message),1)):_("",!0)]),o("div",ie,[ne,o("div",ae,[i(y,{dense:"",outlined:"",modelValue:s.lat,"onUpdate:modelValue":e[5]||(e[5]=l=>s.lat=l),placeholder:"latitude"},null,8,["modelValue"]),i(y,{dense:"",outlined:"",modelValue:s.lon,"onUpdate:modelValue":e[6]||(e[6]=l=>s.lon=l),placeholder:"longitude"},null,8,["modelValue"])])]),o("div",de,[me,i(j,{dense:"",modelValue:s.form.assigned_to_school_head,"onUpdate:modelValue":e[7]||(e[7]=l=>s.form.assigned_to_school_head=l)},null,8,["modelValue"])]),o("div",ce,[i($,{outline:"",label:"Back",onClick:e[8]||(e[8]=l=>t.$router.go(-1)),"no-caps":"",style:{"min-width":"100px"}}),i($,{unelevated:"",color:"primary",label:"Submit",type:"submit","no-caps":"",style:{"min-width":"100px"}})])],32)])])}var we=M(G,[["render",ue]]);export{we as default};
