import{_ as u,Z as S,a8 as k,a1 as m,a2 as f,ad as s,d as n,ah as I,a3 as _,b2 as h,ae as p,ai as i,J as g,af as b,as as N,F as A,b5 as C,b3 as P,b4 as T}from"./index.56aced16.js";import{Q as V}from"./QTooltip.0e0f570b.js";import{b as D}from"./axios.af9b5afd.js";import{u as M,g as L}from"./generateHeaders.891fe619.js";import"./auth_user_store.0a1df304.js";import"./position-engine.9dfbd25a.js";import"./selection.e4c60947.js";const{getSettings:z}=S(M()),H={data(){return{response_data:"",all_docs:[],table_docs:[],search_term:"",cancelToken:void 0,sort_ASC:!0}},computed:{encryptionEnabled(){var o;return(o=z.value)==null?void 0:o.api_encryption_enabled},students(){return this.table_docs.map(o=>({...o.user,...o}))}},mounted(){this.fetchMany(),this.setupPagination()},methods:{async fetchMany(o={}){try{typeof this.cancelToken!="undefined"&&this.cancelToken.cancel("Operation canceled due to new request."),this.cancelToken=D.CancelToken.source();let t=(await this.$api.get("/api/v1/admin/students/",{headers:{...L()},cancelToken:this.cancelToken.token,params:o})).data;this.encryptionEnabled&&(t=JSON.parse(k(t)));const{message:d,success:l,results:r}=t;this.response_data=r,this.all_docs=this.response_data.docs,this.table_docs=this.all_docs}catch{}},setupPagination(){const o=document.querySelector(".trigger");new IntersectionObserver(([t])=>{var d;console.log("entry.isIntersecting ================ ",t.isIntersecting),!!this.response_data&&t.isIntersecting&&this.fetchNext((d=this.response_data)==null?void 0:d.nextPage)},{root:null,threshold:0}).observe(o)},fetchNext(o){!this.response_data.nextPage||this.response_data.page>=o||this.fetchMany({page:o,size:this.response_data.limit,search_term:this.search_term})},filterData(o){o=o.trim(),this.fetchMany({search_term:o})},sortList(o){this.sort_ASC?(this.table_docs.sort((a,t)=>a[o]>t[o]?-1:1),this.sort_ASC=!1):(this.table_docs.sort((a,t)=>a[o]<t[o]?-1:1),this.sort_ASC=!0)}}},c=o=>(P("data-v-7cb34a50"),o=o(),T(),o),Q={class:""},q={class:"flex justify-between q-my-sm data-table-top"},B={class:"flex",style:{gap:"5px"}},E={class:"flex",style:{gap:"0px 5px"}},F={class:"q-px-sm text-grey text-h6"},O={class:""},j=c(()=>s("th",{scope:"col"},"First name",-1)),J=c(()=>s("th",{scope:"col"},"Last name",-1)),R=c(()=>s("th",{scope:"col"},"Phone number",-1)),U=c(()=>s("th",{scope:"col"},"Ward",-1)),W=c(()=>s("th",{scope:"col"},"Has ID",-1)),Y=c(()=>s("th",{scope:"col"},"National ID",-1)),Z=c(()=>s("th",{scope:"col"},"Polling center",-1)),G=c(()=>s("th",{scope:"col"},"Status",-1)),K={scope:"col"},X=c(()=>s("th",{scope:"col"},"Actions",-1)),$={"data-label":"First name",class:"text-capitalize"},ee={"data-label":"Last name",class:"text-capitalize"},se={"data-label":"Phone number",class:"text-capitalize"},oe={"data-label":"Location",class:"text-capitalize"},ae={"data-label":"Has ID"},te={"data-label":"National ID"},ie={"data-label":"Polling center"},ce={"data-label":"Status"},le={"data-label":"High school completion year"},re={"data-label":"Action"},ne={class:"flex justify-center items-center",style:{gap:"5px"}},_e=c(()=>s("span",{class:"trigger"},null,-1)),he=c(()=>s("div",{class:""},"No Students",-1)),de=[he];function pe(o,a,t,d,l,r){var y,x,v;return m(),f("div",Q,[s("div",q,[s("div",B,[n(I,{modelValue:l.search_term,"onUpdate:modelValue":[a[0]||(a[0]=e=>l.search_term=e),r.filterData],placeholder:"search",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),n(p,{outline:"",color:"grey-5",dense:"",icon:"refresh",onClick:r.fetchMany},{default:_(()=>[n(V,null,{default:_(()=>[h(" Refresh ")]),_:1})]),_:1},8,["onClick"])]),s("div",E,[s("span",F,i((y=l.all_docs)==null?void 0:y.length)+" of "+i((x=l.response_data)==null?void 0:x.totalDocs),1),g(n(p,{outline:"",outlined:"",color:"grey-5",onClick:a[1]||(a[1]=e=>{var w;return r.fetchNext((w=l.response_data)==null?void 0:w.nextPage)}),"no-caps":""},{default:_(()=>[h("Next")]),_:1},512),[[b,(v=l.response_data)==null?void 0:v.nextPage]])])]),s("table",O,[s("thead",null,[s("tr",null,[j,J,R,U,W,Y,Z,G,s("th",K,[s("div",{class:"sortable-table-head",onClick:a[2]||(a[2]=e=>r.sortList("highschool_completion_year"))},[h(" High school completion year "),n(N,{name:"arrow_downward"}),n(N,{name:"arrow_upward"})])]),X])]),g(s("tbody",null,[(m(!0),f(A,null,C(r.students,e=>(m(),f("tr",{key:e==null?void 0:e.id},[s("td",$,i((e==null?void 0:e.first_name)||"N/A"),1),s("td",ee,i(e==null?void 0:e.last_name),1),s("td",se,i((e==null?void 0:e.phone_number)||"N/A"),1),s("td",oe,i((e==null?void 0:e.ward)||"N/A"),1),s("td",ae,i(e!=null&&e.has_no_national_id?"Yes":"No"),1),s("td",te,i((e==null?void 0:e.national_id)||"N/A"),1),s("td",ie,i((e==null?void 0:e.polling_center)||"N/A"),1),s("td",ce,i((e==null?void 0:e.status)||"N/A"),1),s("td",le,i((e==null?void 0:e.highschool_completion_year)||"N/A"),1),s("td",re,[s("div",ne,[n(p,{unelevated:"","no-caps":"",dense:"",color:"orange",style:{"min-width":"50px"},to:`/students/view/${e==null?void 0:e.id}`},{default:_(()=>[h("View")]),_:2},1032,["to"]),n(p,{unelevated:"","no-caps":"",dense:"",color:"green",style:{"min-width":"50px"},to:`/students/edit/${e==null?void 0:e.id}`},{default:_(()=>[h("Edit")]),_:2},1032,["to"])])])]))),128))],512),[[b,r.students]]),_e,g(s("div",null,de,512),[[b,!l.table_docs.length]])])])}var we=u(H,[["render",pe],["__scopeId","data-v-7cb34a50"]]);export{we as default};
