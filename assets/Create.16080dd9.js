import{_ as S,Z as w,$ as q,a6 as E,aa as k,a8 as N,a1 as d,a4 as B,a3 as m,ad as t,ak as C,d as n,ah as _,a2 as y,ai as v,a5 as h,ae as b,b2 as g}from"./index.56aced16.js";import{Q as M}from"./QPage.b73b0375.js";import{u as T,g as U,r as A}from"./generateHeaders.891fe619.js";import{u as P}from"./index.62701558.js";import{c as x,r as V}from"./index.33746749.js";import{u as Q}from"./auth_user_store.0a1df304.js";import"./axios.af9b5afd.js";const{getSettings:D}=w(T()),{getAuthUserDetails:$}=w(Q()),O={setup(){return{v$:P()}},data(){return{form:{from:null,to:null,sender_role:"",receiver_role:"",title:"test title",body:"some text for the body"},datetime:null,thread_id:null}},computed:{encryptionEnabled(){var e;return(e=D.value)==null?void 0:e.api_encryption_enabled}},components:{UsersFilter:q(()=>E(()=>import("./UsersFilter.ab4b748a.js"),["assets/UsersFilter.ab4b748a.js","assets/QItemLabel.cffd16e9.js","assets/index.56aced16.js","assets/index.93ddf4f0.css","assets/QSelect.1fc42082.js","assets/QMenu.58a91336.js","assets/position-engine.9dfbd25a.js","assets/selection.e4c60947.js","assets/format.a33550d6.js","assets/axios.af9b5afd.js","assets/generateHeaders.891fe619.js","assets/auth_user_store.0a1df304.js"]))},validations(){return{form:{title:{required:x.withMessage("Title is required",V)},body:{required:x.withMessage("Message is required",V)}}}},methods:{async submit(){try{if(this.v$.$touch(),this.v$.$error)return;let e={...this.form,from:$.value.id,sender_role:$.value.role,receiver_role:"admin"};this.encryptionEnabled&&(e=k(JSON.stringify(e)));let i=(await this.$api.post("/api/v1/communications/new/",e,{headers:{...U()}})).data;this.encryptionEnabled&&(i=JSON.parse(N(i)));const{message:r,success:o,results:l}=i}catch(e){A({caller:"submit message",error:e,api_encryption_enabled:this.api_encryption_enabled})}}}},I={class:"form-container"},J=t("div",{class:"q-my-md"},[t("div",{class:"text-center"},"Enter title and body")],-1),R={class:"q-my-md"},j=t("div",{class:""},"Title",-1),F={key:0,class:"text-red"},H={class:"q-my-md"},L=t("div",{class:""},"Message ",-1),Z={key:0,class:"text-red"},z={class:"flex justify-between"};function G(e,s,i,r,o,l){return d(),B(M,{class:"flex flex-center"},{default:m(()=>{var c,u,p,f;return[t("div",I,[J,t("form",{onSubmit:s[2]||(s[2]=C((...a)=>l.submit&&l.submit(...a),["prevent"]))},[t("div",R,[j,n(_,{outlined:"",modelValue:o.form.title,"onUpdate:modelValue":s[0]||(s[0]=a=>o.form.title=a),dense:""},null,8,["modelValue"]),(c=r.v$.form)!=null&&c.title.$error?(d(),y("div",F,v((u=r.v$.form)==null?void 0:u.title.$errors[0].$message),1)):h("",!0)]),t("div",H,[L,n(_,{outlined:"",modelValue:o.form.body,"onUpdate:modelValue":s[1]||(s[1]=a=>o.form.body=a),type:"textarea"},null,8,["modelValue"]),(p=r.v$.form)!=null&&p.body.$error?(d(),y("div",Z,v((f=r.v$.form)==null?void 0:f.body.$errors[0].$message),1)):h("",!0)]),t("div",z,[n(b,{color:"red",unelevated:"",outline:"","no-caps":"",style:{"min-width":"100px"}},{default:m(()=>[g("Cancel")]),_:1}),n(b,{color:"green",unelevated:"",type:"submit","no-caps":"",style:{"min-width":"100px"}},{default:m(()=>[g("Submit")]),_:1})])],32)])]}),_:1})}var re=S(O,[["render",G]]);export{re as default};
