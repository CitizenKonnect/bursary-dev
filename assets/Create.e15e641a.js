import{Q as y}from"./QSelect.1fc42082.js";import{_ as P,Z as J,a8 as E,aa as D,a1 as m,a2 as u,ad as s,d as l,ai as c,a5 as f,ah as d,aj as B,J as b,af as p,ae as Q,ak as G}from"./index.56aced16.js";import{u as O}from"./index.62701558.js";import{c as a,r as _}from"./index.33746749.js";import{u as W,g as C,p as j,r as L}from"./generateHeaders.891fe619.js";import{u as T}from"./auth_user_store.0a1df304.js";import"./QItemLabel.cffd16e9.js";import"./QMenu.58a91336.js";import"./position-engine.9dfbd25a.js";import"./selection.e4c60947.js";import"./format.a33550d6.js";import"./axios.af9b5afd.js";const{getSettings:A}=J(W()),{getMe:I}=J(T()),R={setup(){return{v$:O()}},data(){return{form:{school:null,number_of_classes:void 0,number_of_students_per_class:void 0,number_of_teachers:void 0,school_has_labs:!1,number_of_labs:void 0,student_gender:null,number_of_boys_toilets:void 0,number_of_girls_toilets:void 0,number_of_teachers_toilets:void 0,school_has_water_source:!1,types_of_water_sources:null,number_of_desks:void 0,number_of_chairs:void 0,number_of_lockers:void 0},school_list:[]}},validations(){return{form:{school:{required:a.withMessage("School is required",_)},number_of_classes:{required:a.withMessage("Number of classes is required",_)},number_of_students_per_class:{required:a.withMessage("Number of students per class is required",_)},number_of_teachers:{required:a.withMessage("Number of teachers is required",_)},number_of_teachers_toilets:{required:a.withMessage("Number of teachers is required",_)},number_of_teachers_toilets:{required:a.withMessage("Number of teachers toilets is required",_)},student_gender:{required:a.withMessage("Student gender composition is required",_)}}}},computed:{encryptionEnabled(){var n;return(n=A.value)==null?void 0:n.api_encryption_enabled},PrimarySchools(){return this.school_list.map(n=>({label:n.name_of_school,value:n.school_serial_number,id:n.id}))},schoolHasGirls(){return this.form.student_gender==="girls"||this.form.student_gender==="mixed"?!0:(this.form.number_of_girls_toilets=void 0,!1)},schoolHasBoys(){return this.form.student_gender==="boys"||this.form.student_gender==="mixed"?!0:(this.form.number_of_boys_toilets=void 0,!1)},waterSources(){return["borehole","well","spring","piped water"]}},mounted(){this.fetchSchools()},methods:{handleSchoolHasLab(n){n||(this.form.number_of_labs=void 0)},handleSchoolHasWaterSource(n){n||(this.form.type_of_water_source=null)},async fetchSchools(n={}){try{let h=(await this.$api.get("/api/v1/school-heads/schools-list/",{headers:{...C()}})).data;this.encryptionEnabled&&(h=JSON.parse(E(h)));const{message:t,success:o,results:i}=h;this.school_list=i}catch{}},async submit(){var n;try{if(this.v$.$touch(),this.v$.$error)return;let e={...this.form};e.school_serial_number=this.form.school.value,e.school=this.form.school.id,e.current_school_head=(n=I.value)==null?void 0:n.id,e.name_of_school=this.form.school.label,e.type_of_school="primary",this.encryptionEnabled&&(e=D(JSON.stringify(e)));let t=(await this.$api.post("/api/v1/school-heads/schools/update/",e,{headers:{...C()}})).data;this.encryptionEnabled&&(t=JSON.parse(E(t)));const{message:o,success:i,results:v}=t;j({message:o}),this.$router.go(-1)}catch(e){L({caller:"update school details form",error:e,api_encryption_enabled:this.encryptionEnabled})}}}},Z={class:"form-container"},z=s("div",{class:"text-h6 text-center"},"Primary school",-1),F={class:"row"},K={class:"col-md-6 col-xs-12 q-pa-sm"},X={class:"q-my-xs"},Y=s("div",{class:"form-lable"},"School *",-1),$={key:0,class:"text-red"},ee={class:"q-my-xs"},se=s("div",{class:"form-lable"},"Number of classes *",-1),oe={key:0,class:"text-red"},re={class:"q-my-xs"},te=s("div",{class:"form-lable"},"Number of students per class *",-1),le={key:0,class:"text-red"},ne={class:"q-my-xs"},ie=s("div",{class:"form-lable"},"Number of teachers *",-1),de={key:0,class:"text-red"},me={class:"q-mt-sm"},ue={class:"q-my-xs"},ae=s("div",{class:"form-lable"},"Number of labs *",-1),_e={class:"col-md-6 col-xs-12 q-pa-sm"},ce={class:"q-my-xs"},fe=s("div",{class:"form-lable"},"Number of teachers toilets *",-1),he={key:0,class:"text-red"},be={class:"q-my-xs"},pe=s("div",{class:"form-lable"},"Gender *",-1),ve={key:0,class:"text-red"},ye={class:"q-my-xs"},Ve=s("div",{class:"form-lable"},"Number of girls toilets *",-1),ge={class:"q-my-xs"},qe=s("div",{class:"form-lable"},"Number of boys toilets *",-1),xe={class:"q-ma-sm"},we=s("div",{class:"text-center text-subtitle2"},"Water source",-1),Se={class:""},ke={class:"q-my-xs"},Ne=s("div",{class:"form-lable"},"Types of water sources *",-1),Ue={class:"q-ma-md"},He=s("div",{class:"text-center text-subtitle2"},"Desks, lockers and chairs",-1),Me={class:"q-my-sm"},Ee=s("div",{class:"form-lable"},"Number of desks *",-1),Be={class:"q-my-sm"},Qe=s("div",{class:"form-lable"},"Number of lockers *",-1),Ce={class:"q-my-sm"},Je=s("div",{class:"form-lable"},"Number of chairs *",-1),Pe={class:"flex justify-between q-ma-md"};function De(n,e,h,t,o,i){var v,V,g,q,x,w,S,k,N,U,H,M;return m(),u("div",Z,[z,s("form",{onSubmit:e[16]||(e[16]=G((...r)=>i.submit&&i.submit(...r),["prevent"]))},[s("div",F,[s("div",K,[s("div",X,[Y,l(y,{dense:"",outlined:"",modelValue:o.form.school,"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.school=r),options:i.PrimarySchools,"popup-content-class":"selection-options"},null,8,["modelValue","options"]),(v=t.v$.form)!=null&&v.school.$error?(m(),u("div",$,c((V=t.v$.form)==null?void 0:V.school.$errors[0].$message),1)):f("",!0)]),s("div",ee,[se,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_classes,"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.number_of_classes=r),type:"number"},null,8,["modelValue"]),(g=t.v$.form)!=null&&g.number_of_classes.$error?(m(),u("div",oe,c((q=t.v$.form)==null?void 0:q.number_of_classes.$errors[0].$message),1)):f("",!0)]),s("div",re,[te,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_students_per_class,"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.number_of_students_per_class=r),type:"number"},null,8,["modelValue"]),(x=t.v$.form)!=null&&x.number_of_students_per_class.$error?(m(),u("div",le,c((w=t.v$.form)==null?void 0:w.number_of_students_per_class.$errors[0].$message),1)):f("",!0)]),s("div",ne,[ie,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_teachers,"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.number_of_teachers=r),type:"number"},null,8,["modelValue"]),(S=t.v$.form)!=null&&S.number_of_teachers.$error?(m(),u("div",de,c((k=t.v$.form)==null?void 0:k.number_of_teachers.$errors[0].$message),1)):f("",!0)]),s("div",me,[l(B,{dense:"",outlined:"",modelValue:o.form.school_has_labs,"onUpdate:modelValue":[e[4]||(e[4]=r=>o.form.school_has_labs=r),i.handleSchoolHasLab],label:"School has lab(s)"},null,8,["modelValue","onUpdate:modelValue"])]),b(s("div",ue,[ae,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_labs,"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.number_of_labs=r),type:"number"},null,8,["modelValue"])],512),[[p,o.form.school_has_labs]])]),s("div",_e,[s("div",ce,[fe,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_teachers_toilets,"onUpdate:modelValue":e[6]||(e[6]=r=>o.form.number_of_teachers_toilets=r),type:"number"},null,8,["modelValue"]),(N=t.v$.form)!=null&&N.number_of_teachers_toilets.$error?(m(),u("div",he,c((U=t.v$.form)==null?void 0:U.number_of_teachers_toilets.$errors[0].$message),1)):f("",!0)]),s("div",be,[pe,l(y,{dense:"",outlined:"",modelValue:o.form.student_gender,"onUpdate:modelValue":e[7]||(e[7]=r=>o.form.student_gender=r),options:["boys","girls","mixed"],"popup-content-class":"selection-options"},null,8,["modelValue"]),(H=t.v$.form)!=null&&H.student_gender.$error?(m(),u("div",ve,c((M=t.v$.form)==null?void 0:M.student_gender.$errors[0].$message),1)):f("",!0)]),b(s("div",ye,[Ve,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_girls_toilets,"onUpdate:modelValue":e[8]||(e[8]=r=>o.form.number_of_girls_toilets=r),type:"number"},null,8,["modelValue"])],512),[[p,i.schoolHasGirls]]),b(s("div",ge,[qe,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_boys_toilets,"onUpdate:modelValue":e[9]||(e[9]=r=>o.form.number_of_boys_toilets=r),type:"number"},null,8,["modelValue"])],512),[[p,i.schoolHasBoys]])])]),s("div",xe,[we,s("div",Se,[l(B,{dense:"",outlined:"",modelValue:o.form.school_has_water_source,"onUpdate:modelValue":[e[10]||(e[10]=r=>o.form.school_has_water_source=r),i.handleSchoolHasWaterSource],label:"School has water source"},null,8,["modelValue","onUpdate:modelValue"])]),b(s("div",ke,[Ne,l(y,{dense:"",outlined:"",modelValue:o.form.types_of_water_sources,"onUpdate:modelValue":e[11]||(e[11]=r=>o.form.types_of_water_sources=r),"use-input":"","use-chips":"",multiple:"",options:i.waterSources,"popup-content-class":"selection-options"},null,8,["modelValue","options"])],512),[[p,o.form.school_has_water_source]])]),s("div",Ue,[He,s("div",Me,[Ee,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_desks,"onUpdate:modelValue":e[12]||(e[12]=r=>o.form.number_of_desks=r),type:"number"},null,8,["modelValue"])]),s("div",Be,[Qe,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_lockers,"onUpdate:modelValue":e[13]||(e[13]=r=>o.form.number_of_lockers=r),type:"number"},null,8,["modelValue"])]),s("div",Ce,[Je,l(d,{dense:"",outlined:"",modelValue:o.form.number_of_chairs,"onUpdate:modelValue":e[14]||(e[14]=r=>o.form.number_of_chairs=r),type:"number"},null,8,["modelValue"])])]),s("div",Pe,[l(Q,{outline:"",label:"back",onClick:e[15]||(e[15]=r=>n.$router.go(-1)),"no-caps":""}),l(Q,{outline:"",label:"submit",type:"submit","no-caps":""})])],32)])}var Ke=P(R,[["render",De]]);export{Ke as default};
