import{_ as N,Z as S,a8 as T,a0 as C,a1 as m,a2 as f,ad as s,d as a,a3 as _,b2 as h,ah as P,ae as u,ai as d,J as b,af as y,as as A,F as D,b5 as V,b3 as p,b4 as M}from"./index.bacfec48.js";import{Q as I}from"./QTooltip.8a56dee4.js";import{b as z}from"./axios.a3b240ae.js";import{u as L,g as Q}from"./generateHeaders.c61a8e24.js";import"./auth_user_store.fb6dbab9.js";import{f as q}from"./index.e3cc403f.js";import"./position-engine.bab6871e.js";import"./selection.0f6ce218.js";const{getSettings:B}=S(L()),E={data(){return{response_data:"",all_docs:[],table_docs:[],search_term:"",cancelToken:void 0,sort_ASC:!0}},computed:{encryptionEnabled(){var t;return(t=B.value)==null?void 0:t.api_encryption_enabled},bursaryApplications(){return this.table_docs.map(t=>({...t.user,...t.student,...t}))}},mounted(){this.fetchMany(),this.setupPagination()},methods:{formateDateTime(t){if(!!t)return q(new Date(t),"yyy-MM-dd HH:mma")},async fetchMany(t={}){try{typeof this.cancelToken!="undefined"&&this.cancelToken.cancel("Operation canceled due to new request."),this.cancelToken=z.CancelToken.source();let r=(await this.$api.get("/api/v1/admin/students/bursary-applications/",{headers:{...Q()},cancelToken:this.cancelToken.token,params:t})).data;this.encryptionEnabled&&(r=JSON.parse(T(r)));const{message:i,success:c,results:n}=r;this.response_data=n,this.all_docs=this.response_data.docs,this.table_docs=this.all_docs}catch{}},setupPagination(){const t=document.querySelector(".trigger");new IntersectionObserver(([r])=>{var i;!this.response_data||r.isIntersecting&&this.fetchNext((i=this.response_data)==null?void 0:i.nextPage)},{root:null,threshold:0}).observe(t)},fetchNext(t){!this.response_data.nextPage||this.response_data.page>=t||this.fetchMany({page:t,size:this.response_data.limit,search_term:this.search_term})},filterData(t){t=t.trim(),this.fetchMany({search_term:t})},sortList(t){this.sort_ASC?(this.table_docs.sort((o,r)=>o[t]>r[t]?-1:1),this.sort_ASC=!1):(this.table_docs.sort((o,r)=>o[t]<r[t]?-1:1),this.sort_ASC=!0)}}},l=t=>(p("data-v-2bd7bf98"),t=t(),M(),t),F={class:""},H={class:"flex",style:{gap:"0px 10px"}},O={class:"flex justify-between q-my-sm data-table-top"},j={class:"flex",style:{gap:"5px"}},J={class:"flex",style:{gap:"0px 5px"}},R={class:"q-px-sm text-grey text-h6"},U={class:""},Z=l(()=>s("th",{scope:"col"},"First name",-1)),G=l(()=>s("th",{scope:"col"},"Last name",-1)),K=l(()=>s("th",{scope:"col"},"Phone number",-1)),W=l(()=>s("th",{scope:"col"},"Location",-1)),X=l(()=>s("th",{scope:"col"},"Polling center",-1)),Y=l(()=>s("th",{scope:"col"},"Status",-1)),$={scope:"col"},ee=l(()=>s("th",{scope:"col"},"Actions",-1)),te={"data-label":"First name",class:"text-capitalize"},se={"data-label":"Last name",class:"text-capitalize"},oe={"data-label":"Phone number",class:"text-capitalize"},re={"data-label":"Location",class:"text-capitalize"},ae={"data-label":"Polling center",class:"text-capitalize"},ne={"data-label":"Polling center",class:"text-capitalize"},de={"data-label":"Datetime"},le={"data-label":"Action"},ce={class:"flex justify-end items-center",style:{gap:"5px"}},_e=l(()=>s("span",{class:"trigger"},null,-1)),he={class:""},ie=l(()=>s("div",{class:"text-left"},"No bursary applications",-1)),ue=[ie];function me(t,o,r,i,c,n){var x,v,w;const g=C("router-link");return m(),f("div",F,[s("div",H,[a(g,{to:"/bursaries/form"},{default:_(()=>[h("Application form")]),_:1}),a(g,{to:"/bursaries/forms"},{default:_(()=>[h("Applications")]),_:1})]),s("div",O,[s("div",j,[a(P,{modelValue:c.search_term,"onUpdate:modelValue":[o[0]||(o[0]=e=>c.search_term=e),n.filterData],placeholder:"search",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),a(u,{outline:"",color:"grey-5",dense:"",icon:"refresh",onClick:n.fetchMany},{default:_(()=>[a(I,null,{default:_(()=>[h(" Refresh ")]),_:1})]),_:1},8,["onClick"])]),s("div",J,[s("span",R,d((x=c.all_docs)==null?void 0:x.length)+" of "+d((v=c.response_data)==null?void 0:v.totalDocs),1),b(a(u,{outline:"",outlined:"",color:"grey-5",onClick:o[1]||(o[1]=e=>{var k;return n.fetchNext((k=c.response_data)==null?void 0:k.nextPage)}),"no-caps":""},{default:_(()=>[h("Next")]),_:1},512),[[y,(w=c.response_data)==null?void 0:w.nextPage]])])]),s("table",U,[s("thead",null,[s("tr",null,[Z,G,K,W,X,Y,s("th",$,[s("div",{class:"sortable-table-head",onClick:o[2]||(o[2]=e=>n.sortList("timestamp"))},[h(" Datetime "),a(A,{name:"arrow_downward"}),a(A,{name:"arrow_upward"})])]),ee])]),b(s("tbody",null,[(m(!0),f(D,null,V(n.bursaryApplications,e=>(m(),f("tr",{key:e==null?void 0:e.id},[s("td",te,d((e==null?void 0:e.first_name)||"N/A"),1),s("td",se,d(e==null?void 0:e.last_name),1),s("td",oe,d((e==null?void 0:e.phone_number)||"N/A"),1),s("td",re,d((e==null?void 0:e.location)||"N/A"),1),s("td",ae,d((e==null?void 0:e.polling_center)||"N/A"),1),s("td",ne,d((e==null?void 0:e.status)||"N/A"),1),s("td",de,d(n.formateDateTime(e==null?void 0:e.timestamp)||"N/A"),1),s("td",le,[s("div",ce,[a(u,{unelevated:"","no-caps":"",dense:"",color:"orange",style:{"min-width":"60px"},to:`/bursaries/view/${e==null?void 0:e.id}`},{default:_(()=>[h("View")]),_:2},1032,["to"]),a(u,{unelevated:"","no-caps":"",dense:"",color:"green",style:{"min-width":"60px"},to:`/bursaries/edit/${e==null?void 0:e.id}`},{default:_(()=>[h("Edit")]),_:2},1032,["to"])])])]))),128))],512),[[y,n.bursaryApplications]]),_e]),b(s("div",he,ue,512),[[y,!c.table_docs.length]])])}var Ae=N(E,[["render",me],["__scopeId","data-v-2bd7bf98"]]);export{Ae as default};
