import{_ as U,Z as N,aa as L,a8 as B,a0 as D,a1 as l,a2 as m,ad as r,d as a,ah as d,ai as u,a5 as p,a3 as h,as as P,b2 as T,ae as E,ak as A}from"./index.58c24f9b.js";import{u as F}from"./index.0927d919.js";import{v as H}from"./validPhoneNumber.889432ad.js";import{c as n,r as c,e as I,m as Q}from"./index.2b518934.js";import{u as z,g as J,p as O,r as R}from"./generateHeaders.1afc8456.js";import{u as j}from"./auth_user_store.67764a02.js";import"./axios.5abb35e7.js";const{getSettings:W}=N(z()),{setAuthUserDetails:Z}=j(),G={setup(){return{v$:F()}},data(){return{form:{first_name:null,last_name:null,phone_number:null,email:null,password:null,confirm_password:null},show_password:{password:!1,confirm_password:!1}}},computed:{encryptionEnabled(){var s;return(s=W.value)==null?void 0:s.api_encryption_enabled},userType(){return this.$route.params.type},role(){const s=this.$route.params.type;if(["primary_school_head_teacher","high_school_principle","tvet_principle"].includes(s))return"institution-head";if(s==="student")return"student";if(s==="admin")return"admin";if(s==="root")return"root"}},validations(){return{form:{first_name:{required:n.withMessage("First name is required",c)},last_name:{required:n.withMessage("Last name is required",c)},phone_number:{required:n.withMessage("Phone number is required",c),is_kenyan:n.withMessage("Phone number must be valid",s=>H(s))},email:{required:n.withMessage("Email is required",c),email:n.withMessage("Email must be valid",I)},password:{required:n.withMessage("Password is required",c),minLength:n.withMessage("Password needs to be atleast 8 characters",Q(8))},confirm_password:{required:n.withMessage("Confirm password is required",c),sameAs:n.withMessage("Passwords must match",s=>this.form.password===s)}}}},mounted(){},methods:{handleCheckHasID(s){},handleCheckHasDisability(s){},async register(){try{if(this.v$.$touch(),this.v$.$error)return;let s={...this.form,user_type:this.userType,role:this.role};this.encryptionEnabled&&(s=L(JSON.stringify(s)));let _=(await this.$api.post("/api/v1/auth/register/",s,{headers:{...J()}})).data;this.encryptionEnabled&&(_=JSON.parse(B(_)));const{message:i,success:o,results:f}=_;O({message:i}),Z(f),this.$router.push("/").then(()=>{this.$router.go()})}catch(s){R({caller:"register form",error:s,api_encryption_enabled:this.api_encryption_enabled})}}}},K={class:"form-container"},X=r("div",{class:"text-center text-h6 q-mb-md"},"Welcome, fill the form below to register",-1),Y={class:"row"},ee={class:"q-pa-xs col-sm-6 col-xs-12"},se=r("div",{class:"form-lable"},"First name *",-1),oe={key:0,class:"text-red"},re={class:"q-pa-xs col-sm-6 col-xs-12"},te=r("div",{class:"form-lable"},"Last name*",-1),ie={key:0,class:"text-red"},ae={class:"row"},ne={class:"q-pa-xs col-sm-6 col-xs-12"},le=r("div",{class:"form-lable"},"Phone number *",-1),me={key:0,class:"text-red"},de={class:"q-pa-xs col-sm-6 col-xs-12"},ue=r("div",{class:"form-lable"},"Email *",-1),pe={key:0,class:"text-red"},ce={class:"row"},_e={class:"q-pa-xs col-sm-6 col-xs-12"},fe=r("div",{class:"form-lable"},"Password *",-1),he={key:0,class:"text-red"},we={class:"q-pa-xs col-sm-6 col-xs-12"},ve=r("div",{class:"form-lable"},"Confirm password *",-1),ye={key:0,class:"text-red"},be={class:"q-my-sm q-mx-xs"},ge={class:"flex justify-between q-mt-md q-mx-xs"};function xe(s,e,_,i,o,f){var w,v,y,b,g,x,q,V,k,$,M,C;const S=D("router-link");return l(),m("div",K,[X,r("form",{onSubmit:e[9]||(e[9]=A((...t)=>f.register&&f.register(...t),["prevent"]))},[r("div",Y,[r("div",ee,[se,a(d,{dense:"",outlined:"",modelValue:o.form.first_name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.form.first_name=t)},null,8,["modelValue"]),(w=i.v$.form)!=null&&w.first_name.$error?(l(),m("div",oe,u((v=i.v$.form)==null?void 0:v.first_name.$errors[0].$message),1)):p("",!0)]),r("div",re,[te,a(d,{dense:"",outlined:"",modelValue:o.form.last_name,"onUpdate:modelValue":e[1]||(e[1]=t=>o.form.last_name=t)},null,8,["modelValue"]),(y=i.v$.form)!=null&&y.last_name.$error?(l(),m("div",ie,u((b=i.v$.form)==null?void 0:b.last_name.$errors[0].$message),1)):p("",!0)])]),r("div",ae,[r("div",ne,[le,a(d,{dense:"",outlined:"",modelValue:o.form.phone_number,"onUpdate:modelValue":e[2]||(e[2]=t=>o.form.phone_number=t)},null,8,["modelValue"]),(g=i.v$.form)!=null&&g.phone_number.$error?(l(),m("div",me,u((x=i.v$.form)==null?void 0:x.phone_number.$errors[0].$message),1)):p("",!0)]),r("div",de,[ue,a(d,{dense:"",outlined:"",modelValue:o.form.email,"onUpdate:modelValue":e[3]||(e[3]=t=>o.form.email=t)},null,8,["modelValue"]),(q=i.v$.form)!=null&&q.email.$error?(l(),m("div",pe,u((V=i.v$.form)==null?void 0:V.email.$errors[0].$message),1)):p("",!0)])]),r("div",ce,[r("div",_e,[fe,a(d,{dense:"",outlined:"",modelValue:o.form.password,"onUpdate:modelValue":e[5]||(e[5]=t=>o.form.password=t),type:o.show_password.password?"text":"password"},{append:h(()=>[a(P,{name:o.show_password.password?"visibility":"visibility_off",size:"30px",color:"grey",class:"q-mr-sm",onClick:e[4]||(e[4]=t=>o.show_password.password=!o.show_password.password)},null,8,["name"])]),_:1},8,["modelValue","type"]),(k=i.v$.form)!=null&&k.password.$error?(l(),m("div",he,u(($=i.v$.form)==null?void 0:$.password.$errors[0].$message),1)):p("",!0)]),r("div",we,[ve,a(d,{dense:"",outlined:"",modelValue:o.form.confirm_password,"onUpdate:modelValue":e[7]||(e[7]=t=>o.form.confirm_password=t),type:o.show_password.confirm_password?"text":"password"},{append:h(()=>[a(P,{name:o.show_password.confirm_password?"visibility":"visibility_off",size:"30px",color:"grey",class:"q-mr-sm",onClick:e[6]||(e[6]=t=>o.show_password.confirm_password=!o.show_password.confirm_password)},null,8,["name"])]),_:1},8,["modelValue","type"]),(M=i.v$.form)!=null&&M.confirm_password.$error?(l(),m("div",ye,u((C=i.v$.form)==null?void 0:C.confirm_password.$errors[0].$message),1)):p("",!0)])]),r("div",be,[a(S,{to:"/auth/login",class:"no-link-decoration"},{default:h(()=>[T("Login")]),_:1})]),r("div",ge,[a(E,{outline:"",label:"back",onClick:e[8]||(e[8]=t=>s.$router.go(-1)),"no-caps":""}),a(E,{outline:"",label:"submit",type:"submit","no-caps":""})])],32)])}var Ee=U(G,[["render",xe]]);export{Ee as default};
