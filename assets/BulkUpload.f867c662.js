import{_ as c,Z as p,$ as _,a6 as m,a8 as f,a0 as h,a1 as u,a2 as y,ad as t,d as n,a3 as v,J as x,af as g,ae as S,b2 as r}from"./index.56aced16.js";import{u as b,g as w,p as E,r as k}from"./generateHeaders.891fe619.js";import"./auth_user_store.0a1df304.js";import"./axios.af9b5afd.js";const{getSettings:B}=p(b()),C={data(){return{selected_file:null}},computed:{encryptionEnabled(){var e;return(e=B.value)==null?void 0:e.api_encryption_enabled}},components:{Uploader:_(()=>m(()=>import("./Uploader.7a98de9c.js"),["assets/Uploader.7a98de9c.js","assets/index.56aced16.js","assets/index.93ddf4f0.css"]))},methods:{handleSelectedFile(e){this.selected_file=e},async upload(){try{const e=new FormData;e.append("school_file",this.selected_file.file);let s=(await this.$api.post("/api/v1/admin/schools/upload/",e,{headers:{...w(),"Content-Type":"multipart/form-data"}})).data;this.encryptionEnabled&&(s=JSON.parse(f(s)));const{message:o,success:l,results:a}=s;E({message:o}),this.$router.go(-1)}catch(e){k({caller:"upload school xls",error:e,api_encryption_enabled:this.api_encryption_enabled})}}}},T={class:"form-container"},N=t("div",{class:"text-h6 text-center"},"Bulk school uploads",-1),U=t("div",{class:"text-caption text-grey"},[r(" ** The file should be .xlsx with the following mandatory fields "),t("span",{class:"text-grey-7"}," [ Ward|MOE reg no|Name Type (primary|secondary)|Gender (boys|girls|mixed)|Lat|Lon ] "),r(" ** ")],-1),D={class:"q-my-sm"},V=t("span",{class:"q-px-sm"},"Select file",-1),$={class:"q-mt-md"};function q(e,i,s,o,l,a){const d=h("Uploader");return u(),y("div",T,[N,U,t("div",D,[n(d,{file_types:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected_file_emitted_event:a.handleSelectedFile},{default:v(()=>[V]),_:1},8,["file_types","onSelected_file_emitted_event"])]),x(t("div",$,[n(S,{dense:"",unelevated:"",color:"primary",class:"full-width",label:"Upload",onClick:a.upload,"no-caps":""},null,8,["onClick"])],512),[[g,l.selected_file]])])}var A=c(C,[["render",q]]);export{A as default};
